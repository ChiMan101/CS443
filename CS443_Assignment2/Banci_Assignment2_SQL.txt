DROP TABLE Hotel CASCADE CONSTRAINTS;
CREATE TABLE Hotel (
	hNum		NUMBER,
	hNoOfRooms	NUMBER,
	hPhone		CHAR(7)	CONSTRAINT hPhone_UQ UNIQUE,
	hAdd		VARCHAR2(50),
	mID		NUMBER,
	CONSTRAINT	Hotel_PK PRIMARY KEY (hNum),
	CONSTRAINT	room_CK CHECK(hNoOfRooms > 0 AND hNoOfRooms <= 200),
	CONSTRAINT	hPhone_CK CHECK(hPhone >= '2202222' and hPhone <= '9909999')
);

DROP TABLE Room CASCADE CONSTRAINTS;
CREATE TABLE Room (
	rNum		NUMBER,
	rRate		NUMBER(5, 2),
	rSize		NUMBER,
	rLoc		NUMBER,
	rOccupied	CHAR(5),
	hNum		NUMBER,
	CONSTRAINT	Room_PK PRIMARY KEY(rNum, hNum),
	CONSTRAINT	rNum_CK CHECK(rNum > 0 AND rNum <= 200),
	CONSTRAINT	rRate_CK CHECK(rRate >= 50),
	CONSTRAINT	rSize_CK CHECK(rSize >= 2 AND rSize <= 4),
	CONSTRAINT	rOccupied_CK CHECK(rOccupied ='false' OR rOccupied ='true'),
	CONSTRAINT	rLoc_CK CHECK(rLoc > 0 AND rLoc <= 100)
);

DROP TABLE Customer CASCADE CONSTRAINTS;
CREATE TABLE Customer (
	cNum		NUMBER,
	cSSN		CHAR(9)	CONSTRAINT cSSN_UQ UNIQUE,
	cName		VARCHAR2(50),
	cCreditCard	VARCHAR2(25),
	cAdd		VARCHAR2(50),
	cStartDate	DATE,
	cEndDate	DATE,
	rNum		NUMBER,
	hNum		NUMBER,
	CONSTRAINT	Customer_PK PRIMARY KEY(cNum),
	CONSTRAINT	cSSN_CK CHECK(cSSN > '660000000' AND cSSN <= '609999999')
);

DROP TABLE Manager CASCADE CONSTRAINTS;
CREATE TABLE Manager (
	mID		NUMBER,
	mName		VARCHAR2(50),
	mAdd		VARCHAR2(50),
	mPhone		CHAR(7),
	mEmail		VARCHAR2(200),
	mSal		NUMBER(7, 2),
	CONSTRAINT	Manager_PK PRIMARY KEY(mID),
	CONSTRAINT	mID_CK CHECK(mID >= 111111 AND mID <= 999999),
	CONSTRAINT	mPhone_CK CHECK(mPhone >= '2222222' AND mPhone <= '9999999')
);

DROP TABLE Caretaker CASCADE CONSTRAINTS;
CREATE TABLE Caretaker (
	ctID		NUMBER,
	ctName		VARCHAR2(50),
	ctAdd		VARCHAR2(50),
	ctPhone		CHAR(7),
	ctEmail		VARCHAR2(200),
	ctSal		NUMBER(7, 2),
	hNum		NUMBER,
	CONSTRAINT	Caretaker_PK PRIMARY KEY(ctID),
	CONSTRAINT	ctID_CK CHECK(ctID >= 111111 AND ctID <= 999999),
	CONSTRAINT	ctPhone_CK CHECK(ctPhone >= '2222222' AND ctPhone  <= '9999999'),
	CONSTRAINT	ctSal_CK CHECK(ctSal > 20000 AND ctSal < 40000)
);

ALTER TABLE Hotel ADD CONSTRAINT Hotel_FK1 FOREIGN KEY(mID) REFERENCES Manager(mID);
ALTER TABLE Room ADD CONSTRAINT Room_FK1 FOREIGN KEY(hNum) REFERENCES Hotel(hNum);
ALTER TABLE Customer ADD CONSTRAINT Customer_FK1 FOREIGN KEY(rNum, hNum) REFERENCES Room(rNum, hNum);
ALTER TABLE Customer ADD CONSTRAINT Customer_FK2 FOREIGN KEY(hNum) REFERENCES Hotel(hNum);
ALTER TABLE Caretaker ADD CONSTRAINT Caretaker_FK1 FOREIGN KEY(hNum) REFERENCES Hotel(hNum);